---
title: "Visualização de dados"
output: github_document
always_allow_html: true
---

# Introdução

Nesse projeto será apresentado o trabalho final do curso de Visualizalção de Dados da [Curso-R](https://curso-r.com/). A proposta foi de realizar um atividade na qual produziremos gráficos com as ferramentas estudadas durante o curso. Para tanto foi utilizado o conjunto de dados sobre jogos de tabuleiros disponibilizados pela [Board Games Geek](https://www.kaggle.com/datasets/jvanelteren/boardgamegeek-reviews) na página da Kaggle. Porém foi utilizada uma versão mais compacta do conjunto de dados usada como base para um [TidyTuesday](https://github.com/rfordatascience/tidytuesday/blob/master/data/2022/2022-01-25/readme.md).

## Primeira Visualização

```{r include=FALSE}

ratings <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-25/ratings.csv")

details <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-25/details.csv")

data <- dplyr::inner_join(ratings, details, by = "id")

data <- data |>
  dplyr::mutate(
    category = stringr::str_replace_all(boardgamecategory, pattern = "\\[|\\]", replacement = ""),
    mechanic = stringr::str_replace_all(boardgamemechanic, pattern = "\\[|\\]", replacement = ""),
    designer = stringr::str_replace_all(boardgamedesigner, pattern = "\\[|\\]", replacement = ""),
    artist = stringr::str_replace_all(boardgameartist, pattern = "\\[|\\]", replacement = ""),
  ) |>
  tidyr::separate(
    category,
    into = "category",
    sep = ","
  ) |>
  tidyr::separate(
    mechanic,
    into = "mechanic",
    sep = ","
  ) |>
  tidyr::separate(
    designer,
    into = "designer",
    sep = ","
  ) |>
  tidyr::separate(
    artist,
    into = "artist",
    sep = ","
  ) |>
  dplyr::mutate(
    category = stringr::str_replace_all(category, pattern = "\\'", replacement = ""),
    mechanic = stringr::str_replace_all(mechanic, pattern = "\\'", replacement = ""),
    designer = stringr::str_replace_all(designer, pattern = "\\'", replacement = ""),
    artist = stringr::str_replace_all(artist, pattern = "\\'", replacement = ""),
  )

```

```{r echo=FALSE, fig.height=12, fig.width=20, message=FALSE, warning=FALSE}

hist <- data |>
  dplyr::select(average) |>
  ggplot2::ggplot() +
  ggplot2::aes(
    x = average,
  ) +
  ggplot2::geom_histogram(
    ggplot2::aes(y = ..density..),
    color = "white",
    fill = "lightblue",
    alpha = .8
  ) +
  ggplot2::theme_minimal() +
  ggplot2::scale_x_continuous(
    limits = c(0, 10),
    breaks = seq(0, 10, 2)
  ) +
  ggplot2::labs(
    title = "Comportamento do atributo <span style='font-size:32pt; color:lightblue'>**média**</span>",
  ) +
  ggplot2::theme(
    panel.grid = ggplot2::element_blank(),
    panel.background = ggplot2::element_rect(
      fill = "black",
      color = "black"
    ),
    plot.background = ggplot2::element_rect(
      fill = "black",
      color = "black"
    ),
    plot.title = ggtext::element_textbox(
      color = "white",
      face = "bold",
      size = 32,
      margin = ggplot2::margin(40)
    ),
    plot.subtitle = ggtext::element_textbox(
      color = "white",
      size = 22,
      margin = ggplot2::margin(10)
    ),
    plot.caption = ggplot2::element_text(
      color = "white",
      size = 8,
      hjust = .5,
      margin = ggplot2::margin(t = 40, b = 10)
    )
  )


box <- data |>
  dplyr::select(average) |>
  ggplot2::ggplot() +
  ggplot2::aes(
    x = average,
  ) +
  ggplot2::geom_boxplot(
    color = "white",
    fill = "lightblue",
    alpha = .8
  ) +
  ggplot2::theme_minimal() +
  ggplot2::scale_x_continuous(
    limits = c(0, 10),
    breaks = seq(0, 10, 2)
  ) +
  ggplot2::labs(
    caption = "Visualização de Thales Henrique | Dados: Board Games Geek - Kaggle"
  ) +
  ggplot2::theme(
    axis.text.y = ggplot2::element_blank(),
    panel.grid = ggplot2::element_blank(),
    panel.background = ggplot2::element_rect(
      fill = "black",
      color = "black"
    ),
    plot.background = ggplot2::element_rect(
      fill = "black",
      color = "black"
    ),
    plot.title = ggplot2::element_text(
      color = "white",
      face = "bold",
      size = 32,
      margin = ggplot2::margin(40)
    ),
    plot.subtitle = ggtext::element_textbox(
      color = "white",
      size = 22,
      margin = ggplot2::margin(10)
    ),
    plot.caption = ggplot2::element_text(
      color = "white",
      size = 8,
      hjust = .5,
      margin = ggplot2::margin(t = 40, b = 10)
    )
  )


library(patchwork)

graph <- hist / box

graph

```

## Segunda Visualização

Ao longo do tempo surgiram vários jogos de tabuleiro. A partir do século XX se intensifica a criação desse tipo de entreterimento. Nessa primeira visualização vamos ver o crescimento da quantidade de jogos a partir do ano de 1900 aaté o fim de 2021. Nele foi marcado alguns dos jogos que mais tive acesso e joguei durante a minha infância e adolescência.

```{r echo=FALSE, fig.height=12, fig.width=20, message=FALSE, warning=FALSE}

data |>
  dplyr::select(
    yearpublished
  ) |>
  dplyr::count(
    yearpublished
  ) |>
  dplyr::arrange(
    desc(yearpublished)
  ) |>
  dplyr::filter(
    yearpublished >= 1900
  ) |>
  na.omit() |>
  ggplot2::ggplot() +
  ggplot2::aes(
    x = yearpublished,
    y = n
  ) +
  ggplot2::geom_area(
    fill = "yellow",
    color = "white",
    alpha = .5
  ) +
  ggplot2::labs(
    title = "O crescimento dos jogos de tabuleiro",
    subtitle = "Mais de <span style='font-size:22pt; color:yellow'>**20.000**</span> jogos diferentes ao fim de 2021",
    caption = "Visualização de Thales Henrique | Dados: Board Games Geek - Kaggle"
  ) +
  ggplot2::annotate(
    geom = "segment",
    x = 1933,
    xend = 1933,
    y = 0,
    yend = 250,
    size = .5,
    color = "white"
  ) +
  ggplot2::annotate(
    geom = "text",
    x = 1933,
    y = 270,
    hjust = 0,
    size = 5,
    color = "white",
    label = "Monopoly",
    fontface = "bold"
  ) +
  ggplot2::annotate(
    geom = "segment",
    x = 1948,
    xend = 1948,
    y = 0,
    yend = 250,
    size = .5,
    color = "white"
  ) +
  ggplot2::annotate(
    geom = "text",
    x = 1948,
    y = 270,
    hjust = 0,
    size = 5,
    color = "white",
    label = "Scrabble",
    fontface = "bold"
  ) +
  ggplot2::annotate(
    geom = "segment",
    x = 1971,
    xend = 1971,
    y = 0,
    yend = 170,
    size = .5,
    color = "white"
  ) +
  ggplot2::annotate(
    geom = "text",
    x = 1971,
    y = 190,
    hjust = 1,
    size = 5,
    color = "white",
    label = "Uno",
    fontface = "bold"
  ) +
  ggplot2::annotate(
    geom = "segment",
    x = 1972,
    xend = 1972,
    y = 0,
    yend = 250,
    size = .5,
    color = "white"
  ) +
  ggplot2::annotate(
    geom = "text",
    x = 1972,
    y = 270,
    hjust = 1,
    size = 5,
    color = "white",
    label = "War",
    fontface = "bold"
  ) +
  ggplot2::annotate(
    geom = "segment",
    x = 1983,
    xend = 1983,
    y = 0,
    yend = 250,
    size = .5,
    color = "white"
  ) +
  ggplot2::annotate(
    geom = "text",
    x = 1983,
    y = 270,
    hjust = 1,
    size = 5,
    color = "white",
    label = "Jenga",
    fontface = "bold"
  ) +
  ggplot2::annotate(
    geom = "segment",
    x = 2008,
    xend = 2008,
    y = 0,
    yend = 800,
    size = .5,
    color = "white"
  ) +
  ggplot2::annotate(
    geom = "text",
    x = 2008,
    y = 820,
    hjust = 1,
    size = 5,
    color = "white",
    label = "Pandemic",
    fontface = "bold"
  ) +
  ggplot2::theme(
    panel.grid = ggplot2::element_blank(),
    panel.background = ggplot2::element_rect(
      fill = "black",
      color = "black"
    ),
    plot.background = ggplot2::element_rect(
      fill = "black",
      color = "black"
    ),
    plot.margin = ggplot2::margin(10, 10, 10, 10),
    axis.text.y = ggplot2::element_blank(),
    axis.ticks.y = ggplot2::element_blank(),
    axis.text.x = ggplot2::element_text(
      color = "white",
      size = 12,
      margin = ggplot2::margin(10)
    ),
    axis.ticks.x = ggplot2::element_blank(),
    plot.title = ggplot2::element_text(
      color = "white",
      face = "bold",
      size = 32,
      margin = ggplot2::margin(40)
    ),
    plot.subtitle = ggtext::element_textbox(
      color = "white",
      size = 22,
      margin = ggplot2::margin(10)
    ),
    plot.caption = ggplot2::element_text(
      color = "white",
      size = 8,
      hjust = .5,
      margin = ggplot2::margin(t = 40, b = 10)
    )
  ) +
  ggplot2::scale_x_continuous(
    limits = c(1900, 2022),
    breaks = seq(1900, 2022, 20)
  )

```

## Terceira Visualização

Nesse comjunto de dados há um atributo chamado `users_rated`. Esse atributo nos diz a quantidade de usuários que deram uma nota a um determinado jogo. Nessa próxima visualização a ideia é tentar ver se a tendência da média das avaliações é crescer ou diminuir com a quantidade de vezes que o jogo foi avaliado pelos usuários.

```{r echo=FALSE, fig.height=12, fig.width=20, message=FALSE, warning=FALSE}

data |>
  dplyr::select(
    users_rated,
    average
  ) |>
  ggplot2::ggplot() +
  ggplot2::aes(
    x = users_rated,
    y = average
  ) +
  ggplot2::geom_point(
    color = "white",
    alpha = .1
  ) +
  ggplot2::geom_smooth(
    colour = "purple",
    size = 2,
    se = FALSE
  ) +
  ggplot2::theme_minimal() +
  ggplot2::labs(
    title = "Comportamento da <span style='font-size:32pt; color:purple'>**média**</span> relacionada a quantidade de reviews",
    subtitle = "Observa-se uma tendência de crescimento da <span style='font-size:22pt; color:purple'>**média**</span> com o aumento da quantidade de reviews realizadas",
    caption = "Visualização de Thales Henrique | Dados: Board Games Geek - Kaggle",
    x = "Reviews",
    y = "Média"
  ) +
  ggplot2::scale_x_log10(
    breaks = c(0, 100, 1000, 10000, 100000),
    labels = c("0", "100", "1.000", "10.000", "100.000")
  ) +
  ggplot2::scale_y_continuous(
    limits = c(0, 10),
    breaks = seq(0, 7.5, 2.5),
    labels = c("0", "2.5", "5.0", "7.5")
  ) +
  ggplot2::theme(
    panel.background = ggplot2::element_rect(
      fill = "black",
      color = "black"
    ),
    panel.grid = ggplot2::element_blank(),
    plot.background = ggplot2::element_rect(
      fill = "black",
      color = "black"
    ),
    plot.margin = ggplot2::margin(10, 10, 10, 10),
    axis.text.x = ggplot2::element_text(
      color = "white",
      size = 12,
      margin = ggplot2::margin(10)
    ),
    axis.text.y = ggplot2::element_text(
      color = "white",
      size = 12,
      margin = ggplot2::margin(10)
    ),
    axis.title.x = ggplot2::element_text(
      color = "white",
      face = "bold",
      size = 12,
      margin = ggplot2::margin(10)
    ),
    axis.title.y = ggplot2::element_text(
      color = "white",
      face = "bold",
      size = 12,
      margin = ggplot2::margin(t = 10, r = 10)
    ),
    plot.title = ggtext::element_textbox(
      color = "white",
      face = "bold",
      size = 32,
      margin = ggplot2::margin(40)
    ),
    plot.subtitle = ggtext::element_textbox(
      color = "white",
      size = 22,
      margin = ggplot2::margin(10)
    ),
    plot.caption = ggplot2::element_text(
      color = "white",
      size = 8,
      hjust = .5,
      margin = ggplot2::margin(t = 40, b = 10)
    )
  )

```

Um detalhe nesse gráfico é que a escala do eixo x é uma escala logarítmica de base 10, já que temos jogos que foram avaliados dezenas de vezes e jogos que chegam a centena de milhar de avaliações. Sendo assim, conseguimos ver uma tendência de aumento da média quando os jogos possuem bastante avaliações realizadas.

## Quarta Visualização

Um pouco parecido com o gráfico anterior, porém com uma proposta um pouco diferente, temos nessa terceira visualização a comparação da tendência da média quando comparamos com o tempo necessário para finalizar o jogo de tabuleiro. Analisando os dados antes de criar esse gráfico, descobri que há um jogo criado em 1979 que simula o teatro de guerra do norte da Africa durante a segunda guerra mundial que tem tempo médio de 60.000 minutos, vocês não leram errado, vou escrever novamente: 60.000 minutos, segue uma página para ver algumas fotos e reviews sobre esse jogo, chama-se [
The Campaign for North Africa: The Desert War 1940-43](https://boardgamegeek.com/boardgame/4815/campaign-north-africa-desert-war-1940-43).

```{r echo=FALSE, fig.height=12, fig.width=20, message=FALSE, warning=FALSE}

data |>
  dplyr::select(
    average,
    playingtime
  ) |>
  dplyr::filter(
    playingtime != 0
  ) |>
  ggplot2::ggplot() +
  ggplot2::aes(
    x = playingtime,
    y = average
  ) +
  ggplot2::geom_smooth(
    colour = "darkgreen",
    size = 1.5
  ) +
  ggplot2::theme_minimal() +
  ggplot2::labs(
    title = "Mais tempo de jogo, maior a diversão?",
    subtitle = "Quanto tempo de jogo é necessário para se ter uma boa <span style='font-size:22pt; color:darkgreen'>**média**</span> de avaliação",
    caption = "Visualização de Thales Henrique | Dados: Board Games Geek - Kaggle",
    x = "Tempo de jogo",
    y = "Média"
  ) +
  ggplot2::annotate(
    geom = "text",
    x = 1,
    y = 6.6,
    hjust = 0,
    size = 4,
    color = "white",
    label = "Jogos rápidos não tem \nnotas tão ruins...",
    fontface = "bold"
  ) +
  ggplot2::annotate(
    geom = "text",
    x = 70,
    y = 7.3,
    hjust = 0,
    size = 4,
    color = "white",
    label = "... já jogos com tempo razoável \nparece empolgar os jogadores...",
    fontface = "bold"
  ) +
  ggplot2::annotate(
    geom = "text",
    x = 6000,
    y = 8.3,
    hjust = 0,
    size = 4,
    color = "white",
    label = "... porém jogos muito longos \nparecem se tornar chatos.",
    fontface = "bold"
  ) +
  ggplot2::scale_x_log10(
    breaks = c(0, 6, 60, 600, 6000, 60000),
    labels = c("0", "6", "60", "600", "6.000", "60.000")
  ) +
  ggplot2::scale_y_continuous(
    limits = c(5, 9),
    breaks = seq(5, 9, 2),
    labels = c("5", "7", "9")
  ) +
  ggplot2::theme(
    panel.background = ggplot2::element_rect(
      fill = "black",
      color = "black"
    ),
    panel.grid = ggplot2::element_blank(),
    plot.background = ggplot2::element_rect(
      fill = "black",
      color = "black"
    ),
    plot.margin = ggplot2::margin(10, 20, 10, 20),
    axis.text.x = ggplot2::element_text(
      color = "white",
      size = 12,
      margin = ggplot2::margin(10)
    ),
    axis.text.y = ggplot2::element_text(
      color = "white",
      size = 12,
      margin = ggplot2::margin(10)
    ),
    axis.title.x = ggplot2::element_text(
      color = "white",
      face = "bold",
      size = 12,
      margin = ggplot2::margin(10)
    ),
    axis.title.y = ggplot2::element_text(
      color = "white",
      face = "bold",
      size = 12,
      margin = ggplot2::margin(t = 10, r = 10)
    ),
    plot.title = ggtext::element_textbox(
      color = "white",
      face = "bold",
      size = 32,
      margin = ggplot2::margin(40)
    ),
    plot.subtitle = ggtext::element_textbox(
      color = "white",
      size = 22,
      margin = ggplot2::margin(10)
    ),
    plot.caption = ggplot2::element_text(
      color = "white",
      size = 8,
      hjust = .5,
      margin = ggplot2::margin(t = 40, b = 10)
    )
  )

```

Aparentemente os jogos com tempo de jogo mediano para a sua finalização, na faixa dos 10 - 1000 minutos, são os que possuem um tendência de média crescente bem estável. Agora jogos com mais de 6.000 minutos de duração possuem um tendência de queda na média bem acentuada. Também seria de se estranhar se essa média não caisse, jogos muito longos tornam-se chatos.
